<div class="flex flex-wrap space-y-4 md:flex-nowrap md:space-y-0">
  <%= render 'shared/settings_nav' %>
  <div class="flex-grow max-w-xl mx-auto">
    <h1 class="text-4xl font-bold mb-4">Storage</h1>
    <% value = @encrypted_config.value || { 'service' => 'disk' } %>
    <% configs = value['configs'] || {} %>
    <%= form_for @encrypted_config, url: settings_storage_index_path, method: :post, html: { autocomplete: 'off', class: 'w-full' } do |f| %>
      <% options = [%w[Disk disk], %w[AWS aws_s3], %w[GCP google], %w[Azure azure]] %>
      <toggle-visible data-element-ids="<%= options.map(&:last).to_json %>" class="block relative">
        <ul class="items-center w-full text-sm font-medium text-gray-900 space-y-2 sm:space-y-0 sm:flex sm:space-x-2">
          <% options.each do |(label, val)| %>
            <li class="w-full border border-neutral-focus rounded-xl hover:bg-neutral hover:text-white">
              <%= f.label :selected, value: val, class: 'w-full py-3 text-sm font-medium flex items-center relative' do %>
                <%= f.radio_button :selected, val, checked: value['service'] == val, data: { action: 'change:toggle-visible#trigger' }, class: 'base-radio self-start ml-3' %>
                <span class="absolute text-center left-0 right-0">
                  <%= label %>
                </span>
              <% end %>
            </li>
          <% end %>
        </ul>
      </toggle-visible>
      <disable-hidden id="disk" class="block my-4 <%= 'hidden' if value['service'] != 'disk' %>">
        <%= render 'disk_form', f: %>
      </disable-hidden>
      <disable-hidden id="aws_s3" class="block my-4 space-y-4 <%= 'hidden' if value['service'] != 'aws_s3' %>">
        <%= render 'aws_form', f:, configs:, value: %>
      </disable-hidden>
      <disable-hidden id="google" class="block mt-4 space-y-4 mb-6 <%= 'hidden' if value['service'] != 'google' %>">
        <%= render 'google_cloud_form', f:, configs:, value: %>
      </disable-hidden>
      <disable-hidden id="azure" class="block mt-4 space-y-4 mb-6 <%= 'hidden' if value['service'] != 'azure' %>">
        <%= render 'azure_form', f:, configs:, value: %>
      </disable-hidden>
      <div class="form-control">
        <%= f.button button_title(title: 'Save', disabled_with: 'Saving'), class: 'base-button' %>
      </div>
    <% end %>
  </div>
  <div class="w-0 md:w-52"></div>
</div>
